#include <.\ButtonConstants.au3>
#include <.\GUIConstantsEx.au3>
#include <.\WindowsConstants.au3>
;#include <.\include\SAP.au3>
#include <.\ClipBoard.au3>
;#include <.\include\IE.au3>
;_IEErrorHandlerRegister()
#Region ### START Koda GUI section ### Form=
$Form1 = GUICreate("Form1", 625, 442, 192, 124)
$Daten_to_Access = GUICtrlCreateButton("S1-Daten nach ACCESS", 424, 72, 163, 49, $WS_GROUP)
GUISetState(@SW_SHOW)
#EndRegion ### END Koda GUI section ###

While 1
	$nMsg = GUIGetMsg()
	Switch $nMsg
		Case $GUI_EVENT_CLOSE
			Exit

		case $Daten_to_Access
			;_SAPSessAttach("SAP Easy Access")
			GetACCESS()		
	EndSwitch
WEnd

func GetACCESS()
	;Daten aus dem SAP werden in einem neuen Datensatz von ACCESS gespeichert
	;_SAPSessAttach("SAP Easy Access")
	;ACCESS vorbereiten...
	;WinActivate("Personal TAVA")
	WinWaitActive("Personal TAVA","",10);10 Sekunden warten bis es los geht
	;Fenster Maximieren
	msgbox(0,"","Ok, es geht los")
	;Doppelklick um Fenster zu maximieren
	MouseClick("left",949,19)
	MouseClick("left",949,19)
	sleep(500)
	;Neuen Datensatz anlegen
	$MyBox= MsgBox(1,"","Neuen Datensatz anlegen?")
	if $MyBox==1 then
		MouseClick("left",195,94)
		sleep(500)
		;Fenster Minimieren Doppelklick
		MouseClick("left",949,19)
		MouseClick("left",949,19)
		sleep(500)
		msgbox(0,"","Pause: Bitte SAP auf die Servicenummer einstellen")
		SendKeepActive("Servicemeldung anzeigen: Servicemeldung PxC")
		MouseClick("left",118,144)
		sleep(500)
		send("^a")
		sleep(500)
		send("^c")
		SendKeepActive ("");
		sleep(500)
		$str = ClipGet()
		ConsoleWrite("Clip:"&$str&@CRLF)
		copy()
		SendKeepActive("")
				;------------------------------------------------------------------------------------------------
				; Run Notepad
				;Run("notepad.exe")
				; Wait for the Notepad become active - it is titled "Untitled - Notepad" on English systems
				;WinWaitActive("[CLASS:Notepad]")
				;------------------------------------------------------------------------------------------------
		WinActivate("Personal TAVA")	
		MouseClick("left",499,224)
		sleep(500)
		Send("^v")
	ElseIf
		Exit
	EndIf
MsgBox(0,"","Ende")
Exit
EndFunc
	


Func copy()
   $clipboard = ClipGet() ; Store current clipboard

   Send("^c") ; Press Ctrl+C to copy whatever was selected
 
EndFunc

Func paste()
	
	  Send("^v")

EndFunc
